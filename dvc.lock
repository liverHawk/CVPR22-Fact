schema: '2.0'
stages:
  prepare_data:
    cmd: uv run split_cicids2017.py
    deps:
    - path: data/CICIDS2017_improved
      hash: md5
      md5: 97448ae36a9acd7110a7c6dafed93e84.dir
      size: 1152270765
      nfiles: 5
    - path: split_cicids2017.py
      hash: md5
      md5: 33968c6051945eac90b902e51b59bb6f
      size: 6893
    outs:
    - path: data/test.csv
      hash: md5
      md5: ed41889327bd3b6465575239fd8b5311
      size: 230415072
    - path: data/train.csv
      hash: md5
      md5: 3c4880896b08cab0f3f076d1ab537b71
      size: 921564131
  create_session_files:
    cmd: uv run create_session_files.py
    deps:
    - path: create_session_files.py
      hash: md5
      md5: 215309e5feaf491084abee85d1512b08
      size: 8537
    - path: data/train.csv
      hash: md5
      md5: 3c4880896b08cab0f3f076d1ab537b71
      size: 921564131
    outs:
    - path: data/class_indices.json
      hash: md5
      md5: f29c90244e31c52ede125a0dcb127cdf
      size: 27448722
    - path: data/column_names.txt
      hash: md5
      md5: 40d60946b24722a772c88cd61ea6895d
      size: 1410
    - path: data/index_list/CICIDS2017_improved
      hash: md5
      md5: 88f4fb9338cc080025a73e92fba982d4.dir
      size: 10932192
      nfiles: 7
  train:
    cmd: uv run train.py
    deps:
    - path: data/index_list/CICIDS2017_improved
      hash: md5
      md5: 88f4fb9338cc080025a73e92fba982d4.dir
      size: 10932192
      nfiles: 7
    - path: data/test.csv
      hash: md5
      md5: ed41889327bd3b6465575239fd8b5311
      size: 230415072
    - path: data/train.csv
      hash: md5
      md5: 3c4880896b08cab0f3f076d1ab537b71
      size: 921564131
    - path: train.py
      hash: md5
      md5: ec385b7f07d4758266b5eb71015b329d
      size: 11761
    params:
      params.yaml:
        train:
          project: fact
          dataset: CICIDS2017_improved
          dataroot: data
          encoder: mlp
          base_mode: ft_cos
          new_mode: avg_cos
          epochs_base: 1
          epochs_new: 100
          batch_size_base: 128
          test_batch_size: 100
          start_session: 0
          lr_base: 0.005
          lr_new: 0.1
          schedule: Milestone
          milestones:
          - 60
          - 70
          step: 20
          decay: 0.0005
          momentum: 0.9
          gamma: 0.25
          temperature: 16
          balance: 0.01
          loss_iter: 0
          alpha: 2.0
          eta: 0.1
          batch_size_new: 0
          not_data_init: false
          set_no_val: false
          num_workers: 8
          debug: false
          model_dir:
          wandb:
            use_wandb: false
            project: origin-fact
            entity: ''
            group: ''
            run_name: ''
            tags: []
            mode: online
            watch: gradients
            watch_freq: 100
    outs:
    - path: checkpoint/CICIDS2017_improved
      hash: md5
      md5: 7073d2b75d378fcc6a78e95fa54217d1.dir
      size: 9323322
      nfiles: 23
