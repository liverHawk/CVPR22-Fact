schema: '2.0'
stages:
  prepare_data:
    cmd: uv run split_cicids2017.py
    deps:
    - path: data/CICIDS2017_improved
      hash: md5
      md5: 97448ae36a9acd7110a7c6dafed93e84.dir
      size: 1152270765
      nfiles: 5
    - path: split_cicids2017.py
      hash: md5
      md5: b1aabc3697cb8f6e3e4227f368bb4127
      size: 7700
    params:
      params.yaml:
        split_cicids:
          data_dir: data/CICIDS2017_improved
          output_dir: data/CICIDS2017_improved
          random_state: 1
          stratify: true
          test_size: 0.2
    outs:
    - path: data/test.csv
      hash: md5
      md5: e48e8cdb0a354ff13908be22847a7d9e
      size: 229983476
    - path: data/train.csv
      hash: md5
      md5: 8de938eafdc821ea1ac5ba9ba24ab66f
      size: 920053282
  create_session_files:
    cmd: uv run create_session_files.py
    deps:
    - path: create_session_files.py
      hash: md5
      md5: 1bf660bcb5d91792a4ef8cd139ff09f5
      size: 8189
    - path: data/train.csv
      hash: md5
      md5: 8de938eafdc821ea1ac5ba9ba24ab66f
      size: 920053282
    params:
      params.yaml:
        create_sessions:
          base_class: 4
          num_classes: 10
          output_dir: data/index_list/CICIDS2017_improved
          random_state: 1
          shot: 5
          train_csv: data/train.csv
          way: 1
    outs:
    - path: data/class_indices.json
      hash: md5
      md5: 53ca2cb662df17651e7daa69780aca92
      size: 27448722
    - path: data/column_names.txt
      hash: md5
      md5: 40d60946b24722a772c88cd61ea6895d
      size: 1410
    - path: data/index_list/CICIDS2017_improved
      hash: md5
      md5: 91d3d2c0769b9a707eedc8b21ab3c18e.dir
      size: 10932246
      nfiles: 7
  train:
    cmd: uv run train.py
    deps:
    - path: data/index_list/CICIDS2017_improved
      hash: md5
      md5: 91d3d2c0769b9a707eedc8b21ab3c18e.dir
      size: 10932246
      nfiles: 7
    - path: data/test.csv
      hash: md5
      md5: e48e8cdb0a354ff13908be22847a7d9e
      size: 229983476
    - path: data/train.csv
      hash: md5
      md5: 8de938eafdc821ea1ac5ba9ba24ab66f
      size: 920053282
    - path: train.py
      hash: md5
      md5: e994e42749b54096b1d9be80477886e1
      size: 12056
    params:
      params.yaml:
        create_sessions:
          base_class: 4
          num_classes: 10
          output_dir: data/index_list/CICIDS2017_improved
          random_state: 1
          shot: 5
          train_csv: data/train.csv
          way: 1
        train:
          alpha: 2.0
          balance: 0.01
          base_mode: ft_cos
          batch_size_base: 128
          batch_size_new: 0
          dataroot: data
          dataset: CICIDS2017_improved
          debug: false
          decay: 0.0005
          encoder: cnn1d
          epochs_base: 1
          epochs_new: 1
          eta: 0.1
          gamma: 0.25
          loss_iter: 0
          lr_base: 0.005
          lr_new: 0.01
          milestones:
          - 60
          - 70
          model_dir:
          momentum: 0.9
          new_mode: avg_cos
          not_data_init: false
          num_workers: 8
          project: fact
          schedule: Step
          set_no_val: false
          start_session: 0
          step: 20
          temperature: 4
          test_batch_size: 100
          wandb:
            entity: ''
            group: ''
            mode: online
            project: origin-fact
            run_name: ''
            tags: []
            use_wandb: false
            watch: gradients
            watch_freq: 100
    outs:
    - path: checkpoint/CICIDS2017_improved
      hash: md5
      md5: 7fc3a3e10c45c0ab0cdefe3d965b7115.dir
      size: 38862558
      nfiles: 23
